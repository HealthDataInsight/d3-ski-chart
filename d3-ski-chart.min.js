/*
 d3-ski-chart v0.0.1
 Copyright (c) 2015-2016 Health Data Insight
 Released under the MIT License
 */
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";var d3,sampleData,skiChart;d3=require("d3"),sampleData=function(t,r){var n,e,a,i,u,l,c;for(c=parseInt(4*t.length/r,10),1>c&&(c=1),i=t.length-1,l=[],e=a=0,u=t.length;u>a;e=++a)n=t[e],(e%c===0||e===i)&&l.push(n);return l},skiChart=function(t,r){var n,e,a,i,u,l,c,o,s,d,p,h,f,x,g,m,y,v,k,_,b,w;return skiChart._id||(skiChart._id=0),i=skiChart._id++,o=null,l={top:15,right:1,bottom:15,left:1},y=263,a=85,c="",u=[],k=null,b=null,_=null,w=null,v=null,h=d3.svg.area().x(function(t){return w(t.index)}).y0(0).y1(function(t){return _(s(t))}).interpolate("basis"),g=null,e=function(){return"primary"},s=function(t){return t.value},p=function(t){return d3.min(t,function(t){return s(t)})},d=function(t){return d3.max(t,function(t){return s(t)})},f=function(){return a-l.top-l.bottom},x=function(){return y-l.left-l.right},m=function(t){return t.append("text").text(""+k[0]+c).attr({"class":"heading","text-anchor":"start",x:0}),t.append("text").text(""+k[1]+c).attr({"class":"heading","text-anchor":"end",x:x()})},n=function(n){return n.each(function(n,B){var C,A,D,W,q,z,F;if(k=d3.extent([p(n),d(n)]),b=d3.extent([0,n.length-1]),_=d3.scale.linear().range([0,x()]).domain(k),w=d3.scale.linear().range([0,f()]).domain(b),v=d3.svg.axis().scale(_).tickSize(l.top+l.bottom-a).tickFormat(function(){return""}),null==o&&0!==n.length){for(B=q=0,z=n.length;z>q;B=++q)A=n[B],A.index=B;return d3.select(this).selectAll(".empty").remove(),o=d3.select(this).append("svg").attr("width","100%").attr("height",a).attr("viewBox","0 0 "+y+" "+a).append("g").attr("transform","translate("+l.left+","+l.top+")"),o.append("rect").attr("class","chartbg").attr("width",x()).attr("height",f()).attr("x",0).attr("y",0),F=sampleData(n,f()),o.append("defs").append("clipPath").attr("id","ski_mask_"+i).append("path").datum(F).attr("class","area").attr("d",h).attr("transform","scale(1 -1) rotate(-90)"),o.append("text").text("Best "+t).attr({"class":"heading position area"}).attr({x:3}).attr({y:11}),o.append("text").text("Worst "+t).attr({"class":"heading position area"}).attr({x:3}).attr({y:function(){return f()-3}}),o.append("rect").attr("class","area").attr("width",x()).attr("height",f()).attr("x",0).attr("y",0).attr("clip-path","url(#ski_mask_"+i+")"),o.append("g").attr("class","x axis").attr("transform",function(){return"translate(0,"+f()+")"}).call(v),o.append("text").text("Best "+t).attr({"class":"heading position"}).attr({x:3}).attr({y:11}).attr("clip-path","url(#ski_mask_"+i+")"),o.append("text").text("Worst "+t).attr({"class":"heading position"}).attr({x:3}).attr({y:function(){return f()-3}}).attr("clip-path","url(#ski_mask_"+i+")"),W=o.selectAll("g.line").data(u).enter().append("g").attr("class","line"),W.append("rect").attr("width",2).attr("height",f).attr("x",function(t){return _(t.value)-1}).attr("y",0).attr("fill",function(t){return t.colour}),W.append("circle").attr("cx",function(t){return _(t.value)}).attr("cy",function(t){return f()-.5}).attr("r",2).attr("fill",function(t){return t.colour}),W.append("text").text(function(t){return t.label}).attr("text-anchor",function(t){return t.anchor}).attr("x",function(t){return _(t.value)-1}).attr("y",function(t){return f()+11}).attr("fill",function(t){return t.colour}),C=t.toLowerCase(),D=o.selectAll("g.geography").data(n).enter().append("g").attr("id",function(t){return r.consume(t.ccg_code)[0]}).attr("class",function(t){return"geography "+e(t)}).attr("transform",function(t,r){return"translate(0,"+w(r)+")"}),D.append("rect").attr("width",function(t){return _(s(t))}).attr("height",2).attr("x",0).attr("y",-1),D.append("circle").attr("cx",function(t){return _(s(t))}).attr("cy",0).attr("r",4),D.append("text").text(function(t){return""+s(t)+c}).attr({"class":"label heading bg","text-anchor":"start",x:function(t){return _(s(t))+8},y:3.5}),D.append("text").text(function(t){return""+s(t)+c}).attr({"class":"label heading","text-anchor":"start",x:function(t){return _(s(t))+8},y:3.5}),o.selectAll("text.label").attr("x",function(t){var r;return r=d3.select(this).node().getBBox(),r.x>y-l.left-r.width-3?y-l.left-r.width-3:r.x}).attr("y",function(t,r){var n;return n=d3.select(this).node().getBBox(),n.x+2<_(s(t))+8?w(r)>d3.mean(w.range())?-8.5:15.5:3.5}),g=o.append("g").attr("class","heading").attr("transform",function(){return"translate(0,-4)"}),m(g)}})},n.svg=function(t){return arguments.length?(o=t,n):o},n.margins=function(t){return arguments.length?(l=t,n):l},n.colour=function(t){return arguments.length?(e=t,n):e},n.valueAccessor=function(t){return arguments.length?(s=t,n):s},n.percent=function(){return c="%",n},n.line=function(t,r,e,a){return u=u.concat({value:t,label:r,colour:e,anchor:a||"middle"}),n},n},module.exports=skiChart;
},{"d3":"d3"}]},{},[1]);
